from langchain_community.vectorstores.pgvector import PGVector
from langchain_community.document_loaders import TextLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings
from decouple import config


OPENAI_API_KEY = config("OPENAI_API_KEY")
if not OPENAI_API_KEY:
    raise ValueError("Must Provide OPENAI API KEY")

loader = TextLoader("data/state_of_the_union.txt", encoding="utf8")
documents = loader.load()

text_splitter = RecursiveCharacterTextSplitter(chunk_size=1000, chunk_overlap=80)
texts = text_splitter.split_documents(documents=documents)

print(len(texts))

# Get OpenAI Embeddings
embeddings = OpenAIEmbeddings()
# vector = embeddings.embed_query("What's cooler than being cool?")
# print('Vector', len(vector))

# doc_vectors = embeddings.embed_documents([t.page_content for t in texts[:5]])
# len(doc_vectors)
# print([len(vec) for vec in doc_vectors])

CONNECTION_STRING = "postgresql+psycopg2://postgres:password@localhost:5432/vector_db"
COLLECTION_NAME = "state_of_union_documents"

# db = PGVector.from_documents(
#     embedding=embeddings,
#     documents=texts,
#     collection_name=COLLECTION_NAME,
#     connection_string=CONNECTION_STRING,
# )

db=PGVector(connection_string=CONNECTION_STRING, embedding_function=embeddings, collection_name=COLLECTION_NAME)
query = 'What was said about COVID 19?'
# searches=db.similarity_search_with_score(query=query, k=4)
# for s in searches:
#     print(s[0].page_content, s[1])

print(embeddings.embed_query(query))

# SELECT document, (embedding <=>'[0.0009154503932222724, 0.007207355462014675, 0.014789287000894547, -0.004811361897736788, 0.00021735893096774817, 0.0020246468484401703, -0.01849629543721676, -0.01447929348796606, -0.004191374406218529, 0.003416389925405383, 0.030327726155519485, 0.02242288365960121, -0.0132264019921422, 0.0049243806861341, 0.007388185244053602, 0.0031645200215280056, 0.04440661147236824, -0.020162513479590416, 0.006974860094487667, -0.010559163056313992, -0.014828036539256573, 0.008272958919405937, -0.0015871035866439342, 0.0007600498502142727, -0.027253620326519012, 0.023288283497095108, 0.011928302235901356, -0.02864859253168106, -0.0004577251966111362, -0.011689349077641964, 0.00987459346652031, -0.011321231722831726, -0.027072791010141373, 0.02323661744594574, -0.026917794719338417, -0.004068668466061354, 0.003855547634884715, -0.017127156257629395, 0.02274579368531704, -0.019762104377150536, 0.027021124958992004, 0.019762104377150536, -0.007355894427746534, 0.009261064231395721, -0.022719960659742355, -0.013846389017999172, 0.018431713804602623, -0.012955157086253166, -0.015964679419994354, 0.01365264318883419, 0.04427744448184967, 0.0024541174061596394, -0.0112824821844697, -0.02260371297597885, -0.0013675247319042683, -0.005621866323053837, -0.004252727143466473, 0.0004932453157380223, 0.002747965743765235, -0.005793008953332901, 0.02503199875354767, -0.02278454415500164, -0.015525522641837597, 0.009758345782756805, -0.012070382945239544, 0.0013877066085115075, -0.011334148235619068, 0.022358302026987076, -0.022823292762041092, 0.017876308411359787, 0.03585594892501831, 0.014130550436675549, 0.002442815573886037, -0.005282810889184475, 0.015603020787239075, -0.003474513767287135, -0.01781172677874565, 0.001937461202032864, -0.006735906470566988, 0.0008767012041062117, 0.014970116317272186, -0.016687998548150063, -0.013368481770157814, 0.007155689876526594, 0.019620023667812347, -0.011217900551855564, -0.00041332506225444376, 0.022138722240924835, -0.009409602731466293, -0.01664924994111061, 0.012419125996530056, 0.02924274653196335, 0.003584303194656968, 0.006474349647760391, -0.024282846599817276, 0.03934337943792343, 0.007969423197209835, 0.04285664111375809, -0.015047615393996239, -0.018018389120697975, -0.005185937974601984, 0.009842302650213242, -0.03585594892501831, -0.013213485479354858, -0.002675310941413045, -0.002442815573886037, 0.01888378895819187, -0.0016113219317048788, 0.00864107720553875, -0.008124420419335365, -0.01964585669338703, 0.027460282668471336, -0.002486408455297351, -0.05430058017373085, 0.016365088522434235, 0.022435801103711128, 0.0032678511925041676, -0.01763089746236801, 0.01238037645816803, -0.019012952223420143, 0.022435801103711128, 0.009525850415229797, 0.01152789406478405, 0.0017453295877203345, 0.012393292970955372, -0.012083299458026886, -0.05461057275533676, -0.010468748398125172, 0.02525157667696476, -0.006884445436298847, 0.02516116201877594, 0.012231837958097458, 0.022823292762041092, -0.0012359387474134564, -0.0033711823634803295, 0.01715298928320408, -0.010617286898195744, 0.010869157500565052, -0.014130550436675549, -0.029966065660119057, 0.016093844547867775, 0.02122165821492672, 0.002768954960629344, 0.008905863389372826, 0.011366439051926136, 0.017747145146131516, 0.02507074736058712, -0.0017469441518187523, 0.00810504611581564, 0.01186372060328722, 0.014220965094864368, 0.006877987179905176, 0.015951763838529587, 0.004985733423382044, 0.006600284483283758, -0.003884609555825591, -0.005689677782356739, -0.001392550184391439, -0.013278067111968994, -0.021815812215209007, -0.006545389536768198, -0.00014702504267916083, 0.015512606129050255, 0.008608785457909107, -0.01204454991966486, 0.02184164524078369, 0.0384133979678154, 0.006500182207673788, -0.02345619723200798, 0.01533177588135004, -0.021725397557020187, 0.02632363885641098, -0.009577516466379166, 0.029707737267017365, 0.009060859680175781, 0.013239317573606968, -0.0021457383409142494, 0.007652971427887678, -0.019930018112063408, -0.03342766314744949, -0.035571787506341934, 0.012651621364057064, 0.022435801103711128, 0.008970445021986961, -0.009525850415229797, -0.008537746034562588, 0.03415098413825035, -0.0031871236860752106, 0.014828036539256573, -0.0032807677052915096, 0.005182708613574505, 0.00670361565425992, 0.0016742893494665623, -0.0196975227445364, -0.669999897480011, -0.04311496764421463, 0.020343342795968056, 0.011133943684399128, 0.01190892793238163, 0.018057137727737427, -0.005101981107145548, 0.015822598710656166, -0.009952092543244362, 0.06081044673919678, -0.016675082966685295, -0.015267194248735905, -0.009887509979307652, -0.009080234915018082, -0.002886817092075944, -0.021634982898831367, 0.009474185295403004, 0.003519721096381545, -0.009751887992024422, 0.01597759686410427, -0.01646842062473297, 0.03384098783135414, -0.024463675916194916, 0.008272958919405937, -0.020123763009905815, 0.0117733059450984, 0.0016419983003288507, -0.008266501128673553, 0.002018188824877143, 0.013420147821307182, -0.026788629591464996, 0.02986273542046547, 0.020511256530880928, -0.013077862560749054, 0.048281531780958176, -0.011915386654436588, -0.005253748968243599, 0.02251329831779003, 0.008938154205679893, 0.03309183567762375, -0.020472506061196327, -0.0013142444659024477, 0.005392600316554308, -0.008938154205679893, -0.011385813355445862, 0.005453953053802252, -0.01414346694946289, -0.00428824732080102, 0.024244097992777824, 0.016907578334212303, -0.010300835594534874, 0.003367953235283494, -0.0023524006828665733, 0.008447330445051193, 0.010236253030598164, 0.01661050133407116, 0.01688174530863762, -0.005983525887131691, 0.010507497936487198, -0.0010454218136146665, 0.01539635844528675, 0.025367824360728264, 0.009177107363939285, -0.01714007370173931, -0.006009358912706375, 0.032575178891420364, -0.011431020684540272, 0.014027219265699387, 0.03156770020723343, -0.007271937560290098, 0.006871528923511505, 0.023107454180717468, -0.003723154542967677, -0.015538438223302364, 0.010649578645825386, 0.02552282251417637, 0.0151509465649724, -0.030560221523046494, 0.01186372060328722, -0.009409602731466293, -0.011211441829800606, -0.014957200735807419, -0.015835516154766083, 0.02140248753130436, 0.006061024498194456, 0.015034698881208897, -0.022048307582736015, 0.013885138556361198, -0.0011116183595731854, -0.013019738718867302, 0.017359651625156403, 0.025509905070066452, 0.001020396244712174, 0.0020068867597728968, 0.03205852583050728, 0.02771861106157303, 0.0025025540962815285, -0.0036230525001883507, 0.029836902394890785, 0.017617980018258095, 0.015525522641837597, -0.015964679419994354, 0.019723353907465935, 0.000823420996312052, -0.0037199254147708416, 0.003577844938263297, -0.020485423505306244, 0.026788629591464996, 0.03097354620695114, -0.008744408376514912, -0.009803553111851215, -0.005089064594358206, -0.0011923458660021424, -0.009383770637214184, 0.0004783107142429799, -0.028726091608405113, 0.010036048479378223, 0.00554113881662488, 0.0020650106016546488, -0.031671032309532166, 0.029914401471614838, -0.005650928243994713, 0.0201495960354805, 0.009635640308260918, 0.003011137479916215, 0.006806946825236082, -0.018276717513799667, -0.020214177668094635, -0.019310029223561287, -0.010998321697115898, 0.003367953235283494, -0.012218921445310116, 0.011159776709973812, 0.00828587543219328, 0.014388877898454666, -0.0017453295877203345, 0.013433064334094524, -0.010591454803943634, 0.003913671709597111, -0.025535738095641136, -0.010023132897913456, -0.00771109526976943, -0.0024670339189469814, 0.013013280928134918, -0.013691392727196217, -0.010378333739936352, 0.01790214143693447, 0.004301163833588362, 0.0026139579713344574, -0.005311872810125351, -0.0006111075635999441, -0.021764148026704788, 0.0036101359874010086, 0.022125806659460068, -0.0020020431838929653, 0.006564764305949211, -0.00801463145762682, -0.02485116943717003, 0.007065275218337774, -0.01642967015504837, -0.0028835879638791084, 0.04735155031085014, 0.003752216463908553, -0.013613893650472164, 0.003154832636937499, 0.010733534581959248, 0.0039621079340577126, 0.026891961693763733, 0.013794723898172379, -0.027021124958992004, 0.003532637609168887, -0.00477907108142972, 0.01298099011182785, 0.02529032714664936, 0.01611967757344246, -0.012606414034962654, -0.005192395765334368, -0.009609807282686234, -0.004691885318607092, 0.015551354736089706, 0.016623416915535927, 0.0038426313549280167, -0.010236253030598164, 0.007013609632849693, -0.0006720568635500968, 0.011592475697398186, 0.0038878386840224266, 0.017579231411218643, -0.013381398282945156, 0.02950107492506504, 0.012328711338341236, 0.017514649778604507, -0.0127355782315135, 0.01817338541150093, 0.012955157086253166, -0.012864742428064346, -0.0020504796411842108, 0.0015418961411342025, -0.015280110761523247, -0.009338563308119774, 0.010294376872479916, 0.014711788855493069, 0.00906731840223074, 0.0030127521604299545, -0.005024482496082783, -0.004859798587858677, -0.0023055789060890675, -0.017256321385502815, 0.0014958814717829227, 0.023172035813331604, 0.01533177588135004, -0.024076184257864952, -0.0011035455390810966, 0.003729612799361348, -0.04900485277175903, -0.0014918451197445393, -0.007614222355186939, 0.0013223172863945365, -0.019439194351434708, 0.005273123271763325, -0.006929652765393257, 0.01648133620619774, -0.0027221329510211945, 0.0013094008900225163, -0.021647900342941284, 0.0020311051048338413, 0.019503775984048843, 0.018199218437075615, 0.015008865855634212, -0.023249534890055656, -0.021957892924547195, 0.013381398282945156, 0.03192935883998871, 0.007175064645707607, 0.00897690374404192, 0.03614011034369469, 0.008505454286932945, -0.011883094906806946, 0.028493596240878105, -0.000469834340037778, -0.024424927309155464, -0.006448516622185707, 0.0014224194455891848, 0.006551847793161869, 0.02870025858283043, -0.018728790804743767, 0.054765570908784866, 0.003765132976695895, -0.004365745931863785, 0.004827507305890322, -0.007032983936369419, -0.024050351232290268, -0.01826380006968975, -0.002696300158277154, -0.004934067837893963, -0.023882437497377396, -0.017617980018258095, -0.0009719596710056067, 0.01590009778738022, 0.025148246437311172, 0.01094665564596653, -0.009364395402371883, 0.015254277735948563, -0.0028545260429382324, 0.0032694656401872635, -0.002688227454200387, -0.011140401475131512, -0.00926752295345068, 0.01423388160765171, 0.005989984143525362, -0.017359651625156403, 0.007310686632990837, 0.027150290086865425, -0.01933586224913597, 0.02510949596762657, 0.015512606129050255, -0.016261758282780647, -0.018560878932476044, -0.009428977966308594, 0.012909949757158756, -0.010107088834047318, -0.03908504918217659, -0.002470263047143817, 0.005650928243994713, -0.030921880155801773, -0.025664903223514557, -0.0002179643779527396, 0.007866092026233673, -0.01287120021879673, 0.027511948719620705, 0.0015322088729590178, 0.034176815301179886, -0.01673966459929943, 0.013730141334235668, -0.005337705370038748, -0.0018454317469149828, 0.021479986608028412, -0.00795004889369011, 0.008847739547491074, -0.005140730179846287, -0.02452825754880905, -0.003694092622026801, 0.015615937300026417, -0.021208740770816803, -0.003426077077165246, 0.007200897205621004, 0.003965337295085192, -0.0031354581005871296, -0.002836765954270959, -0.014983032830059528, 0.03332433104515076, -0.02735695242881775, -0.0036456561647355556, -0.01791505701839924, -0.0016145509434863925, 0.013962636701762676, -0.0230557881295681, -0.003338891314342618, 0.011605392210185528, -0.021570401266217232, -0.018857955932617188, -0.019000036641955376, -0.018857955932617188, -0.043709125369787216, 0.10079964995384216, -0.017837559804320335, -0.016106760129332542, 0.018793374300003052, 0.030870214104652405, 0.007200897205621004, -0.00830525066703558, -0.005360309034585953, 0.01146331150084734, -0.023714525625109673, -0.012231837958097458, -0.019219614565372467, 0.004617615602910519, -0.006858612410724163, 0.004598241299390793, 0.0013247390743345022, -0.014259714633226395, 0.010752909816801548, -0.00785963423550129, -0.013039113953709602, 0.01911628432571888, -0.0036036777310073376, 0.018095888197422028, 0.03818090260028839, 0.00853128731250763, -0.022978289052844048, 0.016184259206056595, 0.03608844429254532, 0.010216878727078438, 0.00897690374404192, -0.008415039628744125, 0.021234573796391487, -0.011566643603146076, 0.013885138556361198, -0.001063989126123488, 0.012903491035103798, 0.006257999688386917, 0.01278078556060791, 0.008046922273933887, 0.018031304702162743, -0.0026284889318048954, 0.009131900034844875, 0.009835844859480858, -0.0040137735195457935, 0.019232532009482384, -0.006377476267516613, 0.00145793950650841, 0.018250884488224983, -0.01289057545363903, -0.015047615393996239, 0.018237967044115067, -0.007433392573148012, -0.012993906624615192, -0.019904185086488724, 0.013368481770157814, 0.012470792047679424, -0.014091800898313522, -0.005812383722513914, -0.0177342277020216, -0.011883094906806946, -0.021906226873397827, -0.03836173191666603, -0.022862041369080544, 0.00920294038951397, -0.011062903329730034, -0.014763453975319862, 0.016455503180623055, -0.018690042197704315, -0.014530958607792854, -0.03035355918109417, 0.026259057223796844, -0.025057831779122353, -0.03278184309601784, -0.0025768233463168144, 0.029165249317884445, -0.00131262990180403, 0.01499594934284687, -0.0027076019905507565, -0.016946326941251755, -0.011243732646107674, -0.006190188229084015, -0.023081621155142784, -0.006671324837952852, -0.03595928102731705, 0.011637683026492596, -0.009377311915159225, 0.0004512669984251261, 0.006826321594417095, -0.016093844547867775, 0.024502426385879517, -0.004246268887072802, 0.022849125787615776, 0.006429141853004694, -0.013691392727196217, -0.010223336517810822, 0.026401137933135033, 0.004368974827229977, 0.030456889420747757, -0.016507169231772423, -0.021337905898690224, 0.012606414034962654, -0.029526907950639725, -0.005437807645648718, -0.0016379619482904673, -0.017256321385502815, -0.030637718737125397, 0.008466705679893494, 0.015008865855634212, 0.014014302752912045, -0.019942933693528175, 0.013639726676046848, -0.022435801103711128, -0.01683007925748825, -0.002013345016166568, 0.004443244077265263, 0.0007386570796370506, 0.021066661924123764, 0.004494910128414631, -0.01002959068864584, -0.020382091403007507, -0.01389805506914854, -0.010468748398125172, 0.0004379469610285014, 0.014350129291415215, 0.005906027276068926, 0.017178822308778763, -0.002586510730907321, -0.028932753950357437, -0.011747472919523716, -0.005037399008870125, 0.016817163676023483, 0.03469347208738327, -0.004262414760887623, -0.009500018320977688, -0.03425431251525879, -0.007414018269628286, -0.0028254641219973564, 0.013303900137543678, 0.002210320206359029, -0.022771626710891724, -0.002668852685019374, -0.02619447559118271, -0.0172821544110775, -0.02552282251417637, -0.001566114486195147, -0.034228481352329254, -0.008001714944839478, -0.0035390956327319145, 0.00119476777035743, 0.030276060104370117, -0.024683255702257156, -0.018070055171847343, -0.018431713804602623, 0.01524136122316122, -0.004268873017281294, -0.0024605756625533104, 0.0038878386840224266, -0.008046922273933887, 0.028416097164154053, 0.009467726573348045, 0.051148973405361176, -0.009926259517669678, 0.004000857472419739, 0.02457992359995842, 0.001879337360151112, -0.024476593360304832, -0.01670091599225998, -0.00859586987644434, -0.00018426062888465822, -0.001742100459523499, 0.01447929348796606, -0.015460940077900887, -0.0005400673253461719, -0.008718575350940228, -0.01204454991966486, -0.018070055171847343, 0.006936111021786928, -0.006710073910653591, -0.01933586224913597, -0.005618637427687645, -0.024231180548667908, -0.010862698778510094, 0.022952456027269363, 0.011521435342729092, -0.020924581214785576, -0.0093579376116395, 0.02336578257381916, 0.004756467416882515, -0.0009889124194160104, -0.010384791530668736, 0.009926259517669678, -0.008389206603169441, 0.006435600109398365, 0.016416754573583603, -0.004817820154130459, -0.023210784420371056, 0.005363538395613432, 0.01508636400103569, 0.0024734921753406525, 0.04802320525050163, 0.006416225805878639, 0.010920822620391846, 0.00641299644485116, 0.013329733163118362, -0.00279801688157022, 0.015654686838388443, -0.019180865958333015, 0.0003788140311371535, 0.011521435342729092, -0.021699564531445503, 0.005237603560090065, -0.02538074180483818, -0.021996643394231796, -0.0034131607972085476, -0.01763089746236801, -0.003455138998106122, -0.02851942926645279, 0.007265479303896427, -0.012115590274333954, -0.02098916284739971, 0.006432371214032173, 0.00944835226982832, 0.00728485407307744, 0.0003919322625733912, 0.02376618981361389, 0.03311767056584358, -0.014259714633226395, -0.007007151376456022, 0.004795216489583254, -0.008602327667176723, -0.015745101496577263, 0.03273017704486847, 0.006884445436298847, -0.01423388160765171, 0.010791658423841, -0.0004976853379048407, 0.03304016962647438, -0.005502389743924141, -0.037715911865234375, 0.011934760957956314, 0.033014338463544846, -0.002565521514043212, -0.01956835761666298, -0.026917794719338417, -0.0028609842993319035, 0.04099667817354202, -0.008085670880973339, -0.018677126616239548, -0.003403473412618041, -0.028855254873633385, -0.0006030348013155162, 0.006299978122115135, -0.012683912180364132, 0.02076958306133747, 0.013239317573606968, -0.007310686632990837, -0.000568725576158613, -0.009945633821189404, 0.01942627690732479, -0.014001386240124702, -0.02193205989897251, 0.021815812215209007, -0.003810340305790305, -0.010507497936487198, 0.02283620834350586, 0.006974860094487667, -0.0010470362612977624, 0.026840295642614365, -0.01898711919784546, 0.021570401266217232, -0.04086751490831375, -0.024864085018634796, -0.003258163807913661, -0.007678804453462362, 0.020072096958756447, -0.0015798381064087152, -0.009144816547632217, -0.015745101496577263, -0.02789944037795067, -0.006212792359292507, 0.03957587480545044, 0.023921187967061996, -0.0005263436469249427, -0.010391250252723694, -0.002812547842040658, 0.00037639218498952687, -0.014737620949745178, -0.015874264761805534, 0.005340934731066227, 0.003322745906189084, -0.03022439405322075, -0.015861349180340767, 0.010281460359692574, 0.0034422227181494236, -0.006128835491836071, 3.002055746037513e-05, 0.01239975169301033, 0.02385660447180271, -0.02359827794134617, 0.01750173233449459, 0.02605239488184452, -0.00453365920111537, -0.008705658838152885, 0.011140401475131512, -0.006632575299590826, -0.029036084190011024, 0.01608092710375786, 0.001961679430678487, -0.013239317573606968, -0.043450795114040375, 0.009461268782615662, 0.011941218748688698, 0.00815025344491005, -0.01499594934284687, 0.032704345881938934, 0.01045583188533783, -0.026736963540315628, -0.02009792998433113, -0.005692906677722931, 0.05399058386683464, 0.00559603376314044, -0.0032081129029393196, 0.0235466118901968, -0.01490553468465805, 0.002258756896480918, -0.0011051601031795144, 0.0010074798483401537, 0.006461433134973049, -0.024928666651248932, -0.009790637530386448, -0.007175064645707607, 0.01893545314669609, 0.020136680454015732, -0.02367577515542507, -0.027382785454392433, 0.0004928417038172483, -0.010998321697115898, 0.009209399111568928, 0.010048964992165565, -0.02269412763416767, -0.0038200276903808117, 0.014130550436675549, 0.00042422328260727227, -0.0029465556144714355, 0.01076582632958889, -0.023262450471520424, -0.02820943482220173, 0.003322745906189084, -0.002588125178590417, -0.02049833908677101, 0.011534351855516434, 0.01974918693304062, 0.016868827864527702, -0.01042999979108572, -0.026439886540174484, 0.009532309137284756, -0.01655883528292179, 0.013013280928134918, 0.007355894427746534, 0.018057137727737427, 0.0093579376116395, 0.003526179352775216, -0.002347557106986642, 0.014440543949604034, -0.003292069537565112, -0.006716532167047262, -0.00030817740480415523, 0.013155361637473106, -0.008938154205679893, -0.02583281509578228, 0.005789779592305422, -0.008415039628744125, -0.002258756896480918, 0.025316160172224045, 0.016494253650307655, 0.013265150599181652, -0.021454153582453728, 0.013213485479354858, -0.011889553628861904, -0.01123727485537529, -0.040092531591653824, 0.004446473438292742, 0.008854197338223457, 0.0010777127463370562, -0.00810504611581564, -0.014065967872738838, -0.011967051774263382, 0.03911088407039642, 0.015047615393996239, -0.012593497522175312, 0.002901348052546382, 0.020304592326283455, -0.004268873017281294, 0.0009816469391807914, -0.0009727669530548155, -0.026116976514458656, 0.028131935745477676, -0.019232532009482384, 0.006519556976854801, 0.011992884799838066, -0.00048355801845900714, 0.008247126825153828, -0.016132593154907227, -0.0036811763420701027, -0.01670091599225998, -0.007459225598722696, 0.02753778174519539, -0.003532637609168887, 0.046447403728961945, 0.01105644553899765, -0.010255628265440464, -0.011624767445027828, -0.017747145146131516, 0.006090086419135332, -0.008156711235642433, -0.01302619744092226, -0.01781172677874565, -0.01830255053937435, 0.008272958919405937, -0.003823256818577647, -0.008279417641460896, 0.012993906624615192, -0.00902211107313633, -0.02153165265917778, 0.0021182908676564693, -0.009861676953732967, 0.014918451197445393, -0.013155361637473106, -0.023804940283298492, 0.02167373150587082, -0.007736928295344114, -0.0030434285290539265, 0.012767869047820568, 0.000302324682706967, -0.015835516154766083, 0.0022910479456186295, 0.24551507830619812, 0.022590797394514084, -0.0003196811012458056, 0.01955544203519821, -0.003810340305790305, 0.0025752088986337185, 0.011812054552137852, 0.008918779902160168, -0.007672346197068691, 0.016545917838811874, 0.0108110336586833, -0.02104082889854908, -0.00926752295345068, 0.0025832816027104855, -0.02614280954003334, 0.01606801152229309, -0.017656728625297546, -0.009099609218537807, -0.016545917838811874, -0.0413583368062973, -0.001136643928475678, 0.0033195167779922485, 0.016907578334212303, -0.01960710622370243, 0.009506476111710072, 0.010623745620250702, 0.0013166663702577353, 0.00602227495983243, 0.01258058100938797, -0.0022216220386326313, -0.0005529837217181921, -0.00859586987644434, -0.007846717722713947, 0.008808990009129047, -0.021337905898690224, -0.009655014611780643, -0.0018631918355822563, 0.0083762900903821, 0.017295069992542267, 0.006538931280374527, 0.0003729612799361348, -0.015460940077900887, -0.0004787143552675843, 0.004543346352875233, 0.006639033555984497, 0.005492702592164278, -0.0029853046871721745, -0.022500382736325264, 0.01110165286809206, -0.005318331066519022, -0.004514284431934357, 0.005415203981101513, -0.007924215868115425, 0.03226518630981445, 0.0032371748238801956, -0.00895752850919962, 0.014518042095005512, 0.0022119348868727684, -0.00383294397033751, -0.006865070667117834, -0.007200897205621004, 0.00679403031244874, -0.015538438223302364, 0.006974860094487667, -0.022719960659742355, 0.027821943163871765, -0.01056562177836895, 0.00354232476092875, -0.01633925549685955, -0.019723353907465935, 0.009325646795332432, -0.022409968078136444, -0.021027911454439163, -0.011560184881091118, -0.002726976526901126, -0.0033711823634803295, 0.011340606026351452, 0.009428977966308594, 0.021105410531163216, 0.02426993101835251, 0.002005272312089801, 0.006942569278180599, -0.01695924438536167, 0.0010583382099866867, 0.004123563412576914, -0.03314350172877312, 0.011592475697398186, -0.03125770762562752, -0.028906920924782753, 0.005363538395613432, 0.008944611996412277, -0.011870178394019604, -0.013148902915418148, 0.0172434039413929, 0.018922537565231323, 0.010036048479378223, 0.007943591102957726, 0.01673966459929943, -0.012567664496600628, -0.02042084001004696, -0.0211312435567379, 0.043812453746795654, 0.007885467261075974, 0.004330225754529238, -0.0015136415604501963, 0.006522785872220993, -0.011450395919382572, 0.012909949757158756, 0.020162513479590416, -0.027951106429100037, -0.014156382530927658, 0.01052041444927454, 0.020020432770252228, -0.014117633923888206, 0.00044279059511609375, 0.017036741599440575, -0.006387163884937763, -0.0033421204425394535, -0.005883423611521721, -0.015499689616262913, -0.005286039784550667, -0.02479950338602066, -0.02055000513792038, 0.01646842062473297, 0.0034938883036375046, -0.009428977966308594, -0.001713038538582623, -0.005747801624238491, -0.00703944219276309, -0.035881780087947845, 0.023662859573960304, -0.00339701515622437, -0.016933411359786987, 0.001997199608013034, -0.015745101496577263, -0.016223007813096046, 0.02233246900141239, -0.022642463445663452, 0.0019439193420112133, -0.011876637116074562, -0.009997299872338772, -0.003104781499132514, 0.006051336880773306, -0.015305942855775356, -0.014337212778627872, -0.01608092710375786, 0.030689384788274765, 0.00028032640693709254, 0.01311661209911108, -0.008021089248359203, -0.022719960659742355, -0.028726091608405113, -0.009093151427805424, -0.005793008953332901, 0.004940526094287634, -0.0210924930870533, -0.02089874818921089, 0.005789779592305422, -0.03180019557476044, -0.004662823397666216, -0.033737655729055405, -0.005754259880632162, 0.006722990423440933, -0.004317309241741896, -0.011928302235901356, -0.025329075753688812, -0.16409005224704742, 0.019632939249277115, -0.006852154154330492, -0.0031887381337583065, 0.009009194560348988, 0.016042178496718407, 0.0013731756480410695, -0.011495603248476982, 0.01398846972733736, 0.010513955727219582, 0.04293413832783699, -0.010378333739936352, -0.018819205462932587, 0.020356258377432823, 0.005951235070824623, -0.03428014740347862, -0.0132070267572999, 0.008415039628744125, 0.0240374356508255, 0.013859305530786514, 0.025445323437452316, -0.03329849988222122, 0.0022700587287545204, -0.024334512650966644, -0.005424891132861376, -0.005944776814430952, -0.011547268368303776, 0.014337212778627872, -0.004562721122056246, -0.021066661924123764, -0.02193205989897251, 0.0008871957543306053, 0.014350129291415215, 0.018922537565231323, 0.013200568966567516, 0.0029627010226249695, 0.010830407962203026, -0.025174079462885857, -0.020575838163495064, 0.025006165727972984, 0.03311767056584358, 0.011011237278580666, 0.006955485790967941, 0.005838216282427311, -0.04159083217382431, 0.02042084001004696, -0.008272958919405937, -0.006493723951280117, 0.01076582632958889, 0.0009969852399080992, 0.010662494227290154, -0.014866785146296024, 0.004656365141272545, 0.0005364345852285624, 0.001727569499053061, 0.007782135624438524, 0.017527565360069275, 0.013510562479496002, -0.008156711235642433, -0.019219614565372467, -0.02779611013829708, -0.013846389017999172, -0.009286897256970406, -0.005973838735371828, 0.0016629875171929598, -0.012167256325483322, -0.012955157086253166, -0.010572079569101334, -0.014156382530927658, 0.007013609632849693, -0.011334148235619068, -0.0027447366155683994, -0.006506640464067459, 0.01047520712018013, -0.007736928295344114, 0.0002777027548290789, -0.02318495139479637, 0.018057137727737427, -0.006664866581559181, 0.00530541455373168, -0.00893169641494751, 0.012083299458026886, -0.026478635147213936, -0.0034067025408148766, 0.017088407650589943, -0.0006583331851288676, -0.006806946825236082, 0.009273980744183064, -0.01143747940659523, -0.002465419238433242, 0.017217570915818214, 0.006522785872220993, 0.009390228427946568, 0.00097680336330086, -0.020511256530880928, 0.019180865958333015, 0.019000036641955376, 0.01152789406478405, -0.010178129188716412, -0.007187981158494949, 0.006545389536768198, -0.008434413932263851, -0.026969458907842636, -0.0018244426464661956, 0.02753778174519539, 0.002521928632631898, -0.019671689718961716, -0.00061998754972592, 0.028777755796909332, -0.013458897359669209, -0.00989396870136261, 0.030689384788274765, 0.023120369762182236, 0.025393657386302948, -0.007956507615745068, 0.030431056395173073, -0.0021473527885973454, -0.011224358342587948, 0.0021748002618551254, -0.02421826496720314, 0.04820403456687927, -0.00830525066703558, -0.004294705577194691, 0.011411646381020546, -0.018522128462791443, -0.014685955829918385, -0.11438770592212677, -0.013394314795732498, -0.003358266083523631, 0.013290983624756336, 0.017359651625156403, 0.027641111984848976, 0.007168606389313936, 0.012134965509176254, -0.03495179861783981, 0.006981318350881338, 0.007601305842399597, -0.01844463124871254, -0.013949720188975334, 0.003768361872062087, 0.01655883528292179, -0.0022345385514199734, -0.01307140477001667, 0.007607764098793268, -0.01441471092402935, -0.0031951963901519775, 0.010436457581818104, -0.022616630420088768, 0.012419125996530056, -0.025057831779122353, 0.015706351026892662, -0.02452825754880905, -0.024838251993060112, 0.024334512650966644, 0.006529244128614664, 0.012574123218655586, -0.024024518206715584, -0.003765132976695895, -0.01898711919784546, 0.007226730231195688, -0.011250191368162632, 0.004595011938363314, -0.03541678935289383, -0.027925273403525352, 0.01262578833848238, -0.039420876652002335, 0.0032549346797168255, 0.01714007370173931, -0.0028254641219973564, -0.016197174787521362, 0.00723964674398303, -0.007259021047502756, -0.005699364934116602, 0.029216915369033813, 0.015551354736089706, -0.009170649573206902, -0.019684605300426483, -0.007969423197209835, -0.01018458791077137, -0.009254606440663338, -0.004656365141272545, -0.01710132323205471, 0.006923194508999586, 0.003510033944621682, 0.0003876940463669598, -0.02851942926645279, -0.0037199254147708416, -0.0008831594022922218, -0.011256649158895016, 0.011450395919382572, 0.0007814426789991558, -0.004543346352875233, -3.84212689823471e-05, -0.0041300212033092976, 0.0335826613008976, -0.04104834422469139, -0.025019081309437752, -0.00014712596021126956, -0.020511256530880928, 0.003768361872062087, -0.007898383773863316, 0.008324624970555305, -0.013523478992283344, -0.006923194508999586, 0.02857109345495701, -0.006196646485477686, -0.010539788752794266, 0.0008823521202430129, 0.018018389120697975, -0.03223935514688492, 0.03559761866927147, 0.035881780087947845, -0.014737620949745178, -0.011921844445168972, -0.007853175513446331, 0.01996876671910286, -0.011243732646107674, 0.009661473333835602, -0.010462290607392788, -0.00944835226982832, -0.02412785030901432, 0.02260371297597885, 0.006645491812378168, -0.010249169543385506, 0.003045043209567666, 0.027072791010141373, -0.009228773415088654, -0.014130550436675549, -0.047119054943323135, 0.007943591102957726, -0.006671324837952852, -0.022758711129426956, -0.022681212052702904, -0.007426934316754341, -0.00679403031244874, 0.011017696000635624, -0.008757324889302254, 0.03466763719916344, -0.025690734386444092, 0.018418798223137856, -0.009461268782615662, -0.000721300661098212, -0.028312765061855316, -0.00584144564345479, 0.024076184257864952, -0.011579559184610844, 0.028932753950357437, -0.001961679430678487, 0.01021042000502348, 0.003204883774742484, 0.00364242703653872, 0.021273324266076088, -0.007110482547432184, 0.0356234535574913, -0.00877669919282198, 0.014156382530927658, -0.03285934031009674, -0.01804422214627266, -0.003513262839987874, -9.944624616764486e-05, 0.009047944098711014, 0.0201495960354805, 0.011986426077783108, -0.012386835180222988, 0.026917794719338417, 0.0404541902244091, -0.0007112097227945924, 0.036734264343976974, -0.008841280825436115, -0.01714007370173931, -0.011779763735830784, -0.01018458791077137, -0.002986919367685914, 0.004123563412576914, -0.01340723130851984, 0.007556098513305187, 0.026000728830695152, -0.008970445021986961, 0.021389571949839592, 0.008828364312648773, -0.027331119403243065, -0.020291676744818687, 0.012742036022245884, -0.010907906107604504, 0.018199218437075615, -0.004963129758834839, 0.009913343004882336, -0.011514977551996708, 0.020717918872833252, 0.028984420001506805, 0.003677947213873267, -0.005544368177652359, 0.02436034567654133, 0.007640055380761623, -0.03908504918217659, -0.0011164620518684387, -0.015047615393996239, -0.026607800275087357, 0.0020359486807137728, -0.020808333531022072, 0.010507497936487198, 0.0008347228285856545, 0.008841280825436115, -0.0009800324914976954, -0.0012948699295520782, 0.015163863077759743, -0.003723154542967677, 0.023042870685458183, -0.003590761451050639, -0.020795416086912155, -0.024605756625533104, 0.01664924994111061, 0.015008865855634212, 0.03665676712989807, -0.005289269145578146, 0.011702265590429306, 0.00045570702059194446, 0.015008865855634212, -0.009164191782474518, 0.005547597073018551, -0.00991980079561472, 0.010087714530527592, 0.0003441011649556458, 0.011405187658965588, -0.0022474550642073154, 0.0196587722748518, 0.009816469624638557, 0.03526179492473602, 0.023133287206292152, 0.00017982062126975507, -0.026478635147213936, -0.01615842618048191, -0.02372744120657444, 0.01633925549685955, 0.005967380478978157, -0.01848337985575199, 0.0017760060727596283, 0.021557483822107315, -0.009545225650072098, 0.02722778730094433, 0.004120334051549435, 0.007866092026233673, -0.004246268887072802, 0.005147188436239958, -0.004184916149824858, 0.0033776406198740005, -0.025729484856128693, 0.04378662258386612, 0.001071254606358707, -0.01119206752628088, -0.007394643500447273, -0.004956671502441168, 0.017023826017975807, 0.004039606545120478, 0.018160469830036163, -0.02394702099263668, 0.014182215556502342, -0.002355629811063409, 0.0011487529845908284, 0.003432535333558917, -0.03213602304458618, -0.01907753385603428, 0.001740486011840403, -0.009900426492094994, 0.008854197338223457, 0.02022709511220455, 0.0035746158100664616, 0.04838486388325691, 0.009700221940875053, -0.013135986402630806, -0.006584139075130224, -0.010668952949345112, 0.019723353907465935, 0.006086857058107853, -0.005754259880632162, -0.017450066283345222, -0.018057137727737427, 0.01141810417175293, -0.013923888094723225, 0.00951293483376503, -0.03143853694200516, -0.03174852952361107, 0.003823256818577647, 0.03665676712989807, 0.01750173233449459, -0.01889670453965664, 0.012122048996388912, 0.009751887992024422, 0.009545225650072098, -0.0006672131712548435, 0.006025504320859909, -0.010462290607392788, -1.9614271877799183e-05, 0.025755317881703377, -0.01692049391567707, -0.009080234915018082, -0.044923268258571625, 0.02098916284739971, 0.013471812941133976, -0.026607800275087357, -0.016145510599017143, 0.021479986608028412, -0.000772562634665519, 0.007007151376456022, -0.013613893650472164, 0.015344692394137383, -0.020136680454015732, -0.010326667688786983, 0.021867478266358376, -0.0244895089417696, -0.027098624035716057, -0.006561535410583019, -0.024773670360445976, -0.017217570915818214, -0.005108439363539219, -0.01955544203519821]') as cosine_distance 
# FROM public.langchain_pg_embedding
# ORDER BY cosine_distance
# LIMIT 2

# Use 1-cosine distance for cosine similarity